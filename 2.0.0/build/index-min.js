/*!build time : 2013-10-21 11:24:09 AM*/
KISSY.add("kg/slideBtn/2.0.0/index",function(a,b,c,d){function e(a){var b=this;e.superclass.constructor.call(b,a),b.init()}var f=b.all;return a.extend(e,c,{init:function(){this.elem=this.get("baseEl"),this.disabled=this.get("disabled"),this.defaultStatus=this.get("defaultStatus"),this.handleSize=this.get("handleSize"),this.slideSize=this.get("slideSize"),this.duration=this.get("duration"),this.onChange=this.get("onChange"),this.elem.length&&(this.disabledClass="checkDisabled",this.containerClass="checkContainer",this.labelOnClass="checkLabelOn",this.labelOffClass="checkLabelOff",this.handleClass="checkHandle",this.uncheckedLabel="",this.checkedLabel="",this.setInputElem(),this._wrapDivs(),this._attachEvents(),this._calculateDivsPos(),this._disableSelectionFocus())},setInputElem:function(){this.elem.prop("checked",this.defaultStatus),this.disabled?this.elem.prop("disabled","disabled"):this.elem.prop("disabled","")},isDisabled:function(){return this.disabled},getSlideStatus:function(){var a=!1;return"checked"==this.elem.prop("checked")&&(a=!0),a},refresh:function(){this._didChange()},_wrapDivs:function(){this.elem.wrap("<div class='"+this.containerClass+"' />"),this.container=this.elem.parent(),this.offLabel=f("<label class='"+this.labelOffClass+"'>\n  <span>"+this.uncheckedLabel+"</span>\n</label>").appendTo(this.container),this.offSpan=this.offLabel.children("span"),this.onLabel=f("<label class='"+this.labelOnClass+"'>\n  <span>"+this.checkedLabel+"</span>\n</label>").appendTo(this.container),this.onSpan=this.onLabel.children("span"),this.handle=f("<div class='"+this.handleClass+"'>\n </div>").appendTo(this.container)},_attachEvents:function(){var a,b,c;c=this,a=function(){return c.onGlobalMove.apply(c,arguments)},b=function(){return c.onGlobalUp.apply(c,arguments),f(document).detach(d.Gesture.move,a),f(document).detach(d.Gesture.end,b)},this.elem.on("change",function(){return c.refresh()}),this.container.on(d.Gesture.start,function(){return c.onMouseDown.apply(c,arguments),f(document).on(d.Gesture.move,a),f(document).on(d.Gesture.end,b)})},_calculateDivsPos:function(){return this.handleResize(this.handleSize),this.containerResize(this.slideSize),this._initialPosition()},handleResize:function(a){return this.handle.css({width:a+"px"})},containerResize:function(a){return this.container.css({width:a+"px"})},_initialPosition:function(){var a,b;return a=this._getDimension(this.container,"width"),this.offLabel.css({width:a}),b=0,this.rightSide=a-this._getDimension(this.handle,"width")-b,"checked"==this.defaultStatus?(this.handle.css({left:this.rightSide}),this.onLabel.css({width:a}),this.offSpan.css({marginRight:-this.rightSide})):(this.onLabel.css({width:0}),this.onSpan.css({marginLeft:-this.rightSide})),this.isDisabled()?this.container.addClass(this.disabledClass):void 0},_getDimension:function(a,b){return a[b]()},_disableSelectionFocus:function(){return a.UA.ie?f([this.handle,this.offLabel,this.onLabel,this.container]).attr("unselectable","on"):void 0},onMouseDown:function(a){var b;a.preventDefault(),this.isDisabled()||3!=a.which&&(b=a.pageX||a.originalEvent.changedTouches[0].pageX,this.currentlyClicking=this.handle,this.dragStartPosition=b,this.handleLeftOffset=parseInt(this.handle.css("left"),10)||0)},onGlobalMove:function(a){var b;if(!this.isDisabled())return a.preventDefault(),b=a.pageX||a.originalEvent.changedTouches[0].pageX,!this.dragging&&Math.abs(this.dragStartPosition-b)>this.dragThreshold&&(this.dragging=!0),this.onDragMove(a,b)},onDragMove:function(a,b){var c,d;if(this.currentlyClicking===this.handle)return d=(b+this.handleLeftOffset-this.dragStartPosition)/this.rightSide,0>d&&(d=0),d>1&&(d=1),c=d*this.rightSide,this.handle.css({left:c}),this.onLabel.css({width:c+parseInt(this.handleSize)/2}),this.offSpan.css({marginRight:-c}),this.onSpan.css({marginLeft:-(1-d)*this.rightSide})},onGlobalUp:function(a){var b;if(this.currentlyClicking)return a.preventDefault(),b=a.pageX||a.originalEvent.changedTouches[0].pageX,this.onDragEnd(a,b),!1},onDragEnd:function(a,b){var c;if(this.currentlyClicking===this.handle&&!this.isDisabled())return this.dragging?(c=(b-this.dragStartPosition)/this.rightSide,this.elem.prop("checked",c>=.5)):this.elem.prop("checked",!this.elem.prop("checked")),this.currentlyClicking=null,this.dragging=null,this._didChange()},_didChange:function(){var a;if("function"==typeof this.onChange&&this.onChange(this.elem,this.elem.prop("checked")),this.isDisabled())return this.container.addClass(this.disabledClass),!1;this.container.removeClass(this.disabledClass),a=this.elem.prop("checked")?this.rightSide:0;var b=this.elem.prop("checked")?this.rightSide+parseInt(this.handleSize):0;this.handle.animate({left:a},this.duration),this.onLabel.animate({width:b},this.duration)}},{ATTRS:{baseEl:{setter:function(a){return f(a)}},disabled:{value:!1},defaultStatus:{value:""},dragThreshold:{value:5},handleSize:{value:22},slideSize:{value:62},duration:{value:.2},onChange:{value:function(){},setter:function(a){return a}}}}),e},{requires:["node","base","event"]});